<!DOCTYPE html>

<html lang="en">
    <head>
        <link href="styles.css" rel="stylesheet">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Two Problems With Programming</title>
    </head>
    <body>
        <article>
            <header>
                <h1>Two Problems with Programming (and computers in general)</h1>
                <hr>
            </header>
            <main>
                <section>
                    <header>
                        <h2>Float Truncation</h2>
                    </header>
                    <p>Let's say you were making a division quiz to test on your students in C, who are working on division with decimals.
                    You decide to start relatively easy, with 5 / 2. Your code might look something like this. (Let's say you implemented <code>get_float
                    </code>or used a library).</p>
<pre><code>#include &lt;stdio.h&gt;

int main(void)
{
    float answer = get_float("Q1: 5 / 2  ");
    if (answer == 5 / 2)
    {
        printf("Correct!\n");
    }
    else
    {
        printf("Incorrect!\n");
    }
    return 0;
}</code></pre>
                    <p>Let's give this a test to see if it works so far.</p>
<pre><code>$ cc quiz.c -o quiz
$ ./quiz
Q1: 5 / 2  2.5
Incorrect!
$</code></pre>
                    <p>How could it be incorrect? Let's figure out why. Add a trusty <code>printf</code> statement of the answer:</p>
                    <code>printf("%f\n", answer);</code>
<pre><code>$ cc quiz.c -o quiz
$ ./quiz
Q1: 5 / 2  2.5
2.500000
Incorrect!
</code></pre>
                    <p>Well, it worked, so I guess the 5 / 2 is incorrect? Surely the computer can't mess up like that?
                    All right, let's find out:</p>
                    <code>printf("%f\n", 5 / 2);</code>
<pre><code>$ cc quiz.c -o quiz
quiz.c:8:20: warning: format specifies type 'double' but the argument has type 'int' [-Wformat]
    8 |     printf("%f\n", 5 / 2);
      |             ~~     ^~~~~
      |             %d
$</code></pre>
                    <p>That compiler just gave us a warning! It might look a little different depending on the C compiler you use,
                    but it says that 5 / 2 is an <code>int</code>! That is because of how C works with operations.
                    Whenever you perform an operation, if both are <code>int</code>s, then the result is an <code>int</code>.
                    If the expression's result is 2.5, but it is an <code>int</code>, it just straight up cuts that decimal part out.
                    Sure enough, if you type in 2 with our quiz program, it says "Correct!". So how can we fix this?</p>
                    <p>
                        <b>Method 1: Adding a decimal place</b><br>
                        If you are just using constants, a decimal place might be a good strategy. To use this strategy,
                        simply add ".0" to the end. Instead of 5 / 2, write
                        <code>5.0 / 2</code>, and it works!
                    </p>
                    <p>
                        <b>Method 2: Typecasting a variable to a float</b><br>
                        If you are using a variable, you need a different strategy. It is not like you can just
                        do <code>var.0</code>! You could make that variable into a <code>float</code>, but if you are just using it for an <code>int</code>,
                        that might over-complicate things. Instead, use <i>typecasting</i>. This is where you add in parentheses
                        the type you want to change it to. For example,</p>

<pre><code>int a = 5;
if (answer == (float)a / 2)</code></pre>
                </section>
                <hr>
                <section>
                    <header>
                        <h2>Floating-point Imprecision</h2>
                    </header>
                    <p>Here is another problem with programming: <i>floating-point imprecision</i>. Let's say you were making
                    a calculator for your students on division for your lesson. This is probably your starting point (again,
                    let's assume you were getting <code>get_float</code> from an external source).</p>
<pre><code>#include &lt;stdio.h&gt;

int main(void)
{
    float a = get_float("a: ");
    float b = get_float("b: ");
    printf("Answer: %f\n", a / b);
}
</code></pre>
                <p>Unlike the quiz, it does seem to work perfectly fine! We use <code>float</code>s to avoid the truncation problem, so everything seems good.
                When you show that program to the students and performed 1 / 3, however, one student asked, <q>Are you sure 1 / 3 has infinite repeating 3's?</q>
                <q>Yes, </q> you say. You edit the <code>printf</code> statement to display 10 decimal places like this:</p>
                <code>printf("Answer: %.10f\n", a / b);</code>
                <p>and are confident it will display 0.3333333333, but watch what happens:</p>
<pre><code>$ cc calc.c -o calc
$ ./calc
a: 1
b: 3
Answer: 0.3333333433
</code></pre>
                <p>Why is the answer 0.33333334? Floating-point imprecision. Remember, the computer works in base-2, or the <i>binary system</i>. 
                We work in base-10, or the <i>decimal system</i>.
                When converting binary to decimal, there is a little bit of imprecision. If you ever need more precision, you may use
                the <code>double</code> type in C to well, <em>double</em> the precision.</p>
<pre><code>double a = get_double("a: ");
double b = get_double("b: ");</code></pre>
                <p>Now the answer is correctly 0.3333333333.</p>
                <p>Floating-point imprecision still remains a problem, though. There is still imprecision even with the <code>double</code>
                type. It is often annoying in the real world, when it displays 1.20000000000001 instead of 1.2 (<code>printf</code> fixes
                the problem, but never ending decimals still have imprecision). Thus, when comparing two numbers, instead of directly checking
                for equality, you could have a range of values accounting for floating-point imprecision:</p>
<pre><code>if (a > 0.33 && a < 0.34)
{
    printf("Numbers are the same!\n");
}</code></pre>
                </section>
            </main>
            <footer>For the examples used in this article, see all of them <a href="examples">here</a>.</footer>
        </article>
    </body>
</html>